# Swagger é›†æˆæŒ‡å—

@ilhamtahir/nest-core v0.2.0 å¼€å§‹æ”¯æŒå¯é…ç½®çš„ Swagger UI é›†æˆï¼Œè®©æ‚¨å¯ä»¥è½»æ¾åœ°ä¸º NestJS åº”ç”¨æ·»åŠ  API æ–‡æ¡£ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```typescript
// app.module.ts
import { Module } from '@nestjs/common';
import { CoreModule } from '@ilhamtahir/nest-core';

@Module({
  imports: [
    CoreModule.forRoot({
      swagger: {
        enabled: true, // å¯ç”¨ Swagger
        path: 'docs',  // è®¿é—®è·¯å¾„
        title: 'My API',
        description: 'API documentation',
        version: '1.0.0',
      },
    }),
  ],
})
export class AppModule {}
```

```typescript
// main.ts
import { NestFactory } from '@nestjs/core';
import { CoreModule } from '@ilhamtahir/nest-core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  
  // è®¾ç½® Swaggerï¼ˆä½¿ç”¨ CoreModule çš„é…ç½®ï¼‰
  CoreModule.setupSwagger(app);
  
  await app.listen(3000);
  console.log('ğŸ“– API æ–‡æ¡£: http://localhost:3000/docs');
}
bootstrap();
```

## âš™ï¸ é…ç½®é€‰é¡¹

### SwaggerConfig æ¥å£

```typescript
interface SwaggerConfig {
  /** æ˜¯å¦å¯ç”¨ Swaggerï¼Œé»˜è®¤æ ¹æ®ç¯å¢ƒå˜é‡æˆ–å¼€å‘ç¯å¢ƒè‡ªåŠ¨å¯ç”¨ */
  enabled?: boolean;
  
  /** Swagger UI è·¯å¾„ï¼Œé»˜è®¤ä¸º 'docs' */
  path?: string;
  
  /** API æ–‡æ¡£æ ‡é¢˜ */
  title?: string;
  
  /** API æ–‡æ¡£æè¿° */
  description?: string;
  
  /** API ç‰ˆæœ¬ */
  version?: string;
  
  /** API æ ‡ç­¾é…ç½® */
  tags?: Array<{
    name: string;
    description?: string;
  }>;
  
  /** æ˜¯å¦æ·»åŠ  Bearer Auth */
  bearerAuth?: boolean;
  
  /** Swagger UI é€‰é¡¹ */
  swaggerOptions?: {
    persistAuthorization?: boolean;
    tagsSorter?: 'alpha' | 'method';
    operationsSorter?: 'alpha' | 'method';
    [key: string]: any;
  };
  
  /** Swagger æ–‡æ¡£é€‰é¡¹ */
  documentOptions?: SwaggerDocumentOptions;
}
```

### å®Œæ•´é…ç½®ç¤ºä¾‹

```typescript
CoreModule.forRoot({
  swagger: {
    enabled: true,
    path: 'api-docs',
    title: 'Yili-Bili API',
    description: 'Yili-Bili åœ¨çº¿æ•™è‚²å¹³å° API æ–‡æ¡£',
    version: '1.0.0',
    tags: [
      { name: 'è¯¾ç¨‹ç®¡ç†', description: 'è¯¾ç¨‹ç›¸å…³æ¥å£' },
      { name: 'ç”¨æˆ·ç®¡ç†', description: 'ç”¨æˆ·ç›¸å…³æ¥å£' },
      { name: 'è®¢å•ç®¡ç†', description: 'è®¢å•ç›¸å…³æ¥å£' },
    ],
    bearerAuth: true,
    swaggerOptions: {
      persistAuthorization: true,
      tagsSorter: 'alpha',
      operationsSorter: 'alpha',
    },
  },
})
```

## ğŸ”§ ç¯å¢ƒå˜é‡æ§åˆ¶

æ‚¨å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶ Swagger çš„å¯ç”¨çŠ¶æ€ï¼š

```bash
# .env
SWAGGER_ENABLED=true  # æ˜¾å¼å¯ç”¨ Swagger
NODE_ENV=development  # å¼€å‘ç¯å¢ƒä¸‹è‡ªåŠ¨å¯ç”¨
```

é»˜è®¤è¡Œä¸ºï¼š
- å¼€å‘ç¯å¢ƒ (`NODE_ENV=development`) è‡ªåŠ¨å¯ç”¨
- ç”Ÿäº§ç¯å¢ƒé»˜è®¤ç¦ç”¨
- å¯é€šè¿‡ `SWAGGER_ENABLED=true` å¼ºåˆ¶å¯ç”¨

## ğŸ“ é»˜è®¤é…ç½®

å¦‚æœä¸æä¾›é…ç½®ï¼Œå°†ä½¿ç”¨ä»¥ä¸‹é»˜è®¤å€¼ï¼š

```typescript
{
  enabled: process.env.NODE_ENV === 'development' || process.env.SWAGGER_ENABLED === 'true',
  path: 'docs',
  title: 'API Documentation',
  description: 'API documentation generated by @ilhamtahir/nest-core',
  version: '1.0.0',
  tags: [
    { name: 'è®¤è¯', description: 'ç”¨æˆ·è®¤è¯ç›¸å…³æ¥å£' },
    { name: 'ç”¨æˆ·ç®¡ç†', description: 'ç”¨æˆ·ç®¡ç†ç›¸å…³æ¥å£' },
    { name: 'è§’è‰²ç®¡ç†', description: 'è§’è‰²æƒé™ç®¡ç†æ¥å£' },
    { name: 'èœå•ç®¡ç†', description: 'èœå•ç®¡ç†æ¥å£' },
    { name: 'æ–‡ä»¶ç®¡ç†', description: 'æ–‡ä»¶ä¸Šä¼ ä¸‹è½½æ¥å£' },
  ],
  bearerAuth: true,
  swaggerOptions: {
    persistAuthorization: true,
    tagsSorter: 'alpha',
    operationsSorter: 'alpha',
  },
}
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ç¯å¢ƒåŒºåˆ†

```typescript
CoreModule.forRoot({
  swagger: {
    enabled: process.env.NODE_ENV !== 'production',
    title: process.env.NODE_ENV === 'production' ? 'Production API' : 'Development API',
  },
})
```

### 2. åŠ¨æ€é…ç½®

```typescript
const swaggerConfig = {
  enabled: true,
  title: 'My API',
  tags: [
    { name: 'Users', description: 'User management' },
    { name: 'Products', description: 'Product catalog' },
  ],
};

CoreModule.forRoot({
  swagger: swaggerConfig,
})
```

### 3. ç¦ç”¨ Swagger

```typescript
// æ–¹å¼ 1ï¼šé€šè¿‡é…ç½®
CoreModule.forRoot({
  swagger: {
    enabled: false,
  },
})

// æ–¹å¼ 2ï¼šä¸æä¾› swagger é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒä¸‹é»˜è®¤ç¦ç”¨ï¼‰
CoreModule.forRoot({
  // å…¶ä»–é…ç½®...
})

// æ–¹å¼ 3ï¼šç¯å¢ƒå˜é‡
// SWAGGER_ENABLED=false
```

## ğŸ” æ•…éšœæ’é™¤

### Swagger UI æ— æ³•è®¿é—®

1. æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®å¯ç”¨ï¼š
```typescript
swagger: { enabled: true }
```

2. æ£€æŸ¥è·¯å¾„é…ç½®ï¼š
```typescript
swagger: { path: 'docs' } // è®¿é—® http://localhost:3000/docs
```

3. æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š
```bash
NODE_ENV=development
# æˆ–
SWAGGER_ENABLED=true
```

### è‡ªå®šä¹‰æ ‡ç­¾ä¸æ˜¾ç¤º

ç¡®ä¿åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨äº†æ­£ç¡®çš„ `@ApiTags()` è£…é¥°å™¨ï¼š

```typescript
@ApiTags('è¯¾ç¨‹ç®¡ç†')
@Controller('courses')
export class CoursesController {
  // ...
}
```

## ğŸ†• ç‰ˆæœ¬æ›´æ–°

### v0.2.0 æ–°ç‰¹æ€§

- âœ… å¯é…ç½®çš„ Swagger é›†æˆ
- âœ… ç¯å¢ƒå˜é‡æ§åˆ¶
- âœ… é»˜è®¤é…ç½®æ”¯æŒ
- âœ… è‡ªåŠ¨æ ‡ç­¾ç®¡ç†
- âœ… Bearer Auth æ”¯æŒ
- âœ… è‡ªå®šä¹‰ Swagger UI é€‰é¡¹

### è¿ç§»æŒ‡å—

ä»æ‰‹åŠ¨é…ç½®è¿ç§»åˆ° CoreModule é›†æˆï¼š

**ä¹‹å‰ï¼š**
```typescript
// main.ts - æ‰‹åŠ¨é…ç½®
const config = new DocumentBuilder()
  .setTitle('API')
  .build();
const document = SwaggerModule.createDocument(app, config);
SwaggerModule.setup('docs', app, document);
```

**ç°åœ¨ï¼š**
```typescript
// app.module.ts - é…ç½®
CoreModule.forRoot({
  swagger: { enabled: true, title: 'API' }
})

// main.ts - è‡ªåŠ¨è®¾ç½®
CoreModule.setupSwagger(app);
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [NestJS Swagger å®˜æ–¹æ–‡æ¡£](https://docs.nestjs.com/openapi/introduction)
- [@ilhamtahir/nest-core å®Œæ•´æ–‡æ¡£](./README.md)
- [é…ç½®é€‰é¡¹è¯¦è§£](./CONFIG.md)
